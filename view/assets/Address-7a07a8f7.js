import{G as E,r as t,j as e,u as L,i as O,w as F,x as z,y as P,z as T,n,A as D,m as v,L as G,O as W,e as V,f as J}from"./index-df01ba08.js";function Q(d){return E({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M128 405.429C128 428.846 147.198 448 170.667 448h170.667C364.802 448 384 428.846 384 405.429V160H128v245.429zM416 96h-80l-26.785-32H202.786L176 96H96v32h320V96z"}}]})(d)}function R({item:d,deleteAddress:o,setCurrentAddress:i,currentAddress:c}){return t.useEffect(()=>{d.active&&i({userId:d.userId,id:d._id})},[d.active]),e.jsxs("div",{className:"bg-[#f1ecec] drop-shadow-md border-solid border-[1px] py-2 px-3 rounded-md relative mb-2",children:[e.jsx("div",{className:"three_dots absolute right-2 top-1 rounded-full p-2 hover:bg-[#d6cfcfaf] cursor-pointer transition-opacity",onClick:()=>{o({active:!0,userId:d.userId,addressId:d._id})},children:e.jsx(Q,{className:"text-[1.4rem] text-[#d20606]"})}),e.jsx("div",{className:"three_dots absolute right-[4rem] top-1 rounded-full  hover:bg-[#d6cfcfaf] cursor-pointer transition-opacity px-1 mobile:hidden wide:hidden",children:e.jsx("div",{className:"form-control",children:e.jsx("label",{className:"cursor-pointer label",children:e.jsx("input",{type:"checkbox",onChange:l=>{console.log(l),i({id:d._id,userId:d.userId})},checked:d._id===c.id,className:"checkbox checkbox-success"})})})}),e.jsxs("p",{className:"font-serif tracking-wider flex items-center",children:[e.jsx("p",{className:" font-medium mr-4 text-lg",children:d.name})," +",d.mobile]}),e.jsx("div",{className:"address py-1",children:e.jsxs("address",{className:"flex",children:[d.address,", ",d.pincode,", ",d.city,", ",d.state,e.jsx("div",{className:"three_dots flex justify-end right-[4rem] top-1 rounded-full  hover:bg-[#d6cfcfaf] cursor-pointer transition-opacity px-1 md:hidden",onClick:()=>{},children:e.jsx("div",{className:"form-control",children:e.jsx("label",{className:"cursor-pointer label",children:e.jsx("input",{type:"checkbox",onChange:l=>{i({id:d._id,userId:d.userId})},checked:d._id===c.id,className:"checkbox checkbox-success"})})})})]})})]})}const q=[{id:1,placeHolder:"name"},{id:2,placeHolder:"pincode"},{id:3,placeHolder:"locality"},{id:4,placeHolder:"address"},{id:5,placeHolder:"city"},{id:6,placeHolder:"state"},{id:7,placeHolder:"mobile(12 digit)"}];function X({sidebar:d,socket:o}){const i=L(O),[c,l]=t.useState(!1),[x,p]=t.useState(!1),[u,N]=t.useState({id:"",userId:""}),[A,{}]=F(),[I,{isLoading:k,isError:H,error:K}]=z(),[b,m]=t.useState([]),[y,{}]=P(),[_,{}]=T(),[r,h]=t.useState({name:"",pincode:"",locality:"",address:"",city:"",state:"",mobile:""});let g;function f(s){g=s.target.name;const a=s.target.value;h(j=>({...j,[g]:a}))}const w=Boolean(r.name)&&Boolean(r.state)&&Boolean(r.pincode)&&Boolean(r.mobile)&&Boolean(r.locality)&&Boolean(r.city)&&Boolean(r.address);t.useMemo(()=>{(async function(){try{if(i.isHaveId){const a=await I({userId:i.isHaveId}).unwrap();m(a)}}catch(a){console.warn(a)}})()},[]);async function C(){if(r.pincode.length!==6){n.error("pincode is invalid",{duration:2e3,position:"bottom-center"});return}if(w&&r.mobile.length===12)try{if(i.isHaveId){if(o.connected)o.emit("newAddress",{...r,userId:i.isHaveId});else{p(!0);const s=await A({...r,userId:i.isHaveId}).unwrap();n.success(s,{duration:2e3,position:"bottom-center"}),h({name:"",state:"",pincode:"",mobile:"",locality:"",city:"",address:""})}h({name:"",state:"",pincode:"",mobile:"",locality:"",city:"",address:""})}}catch(s){if(V(s)){n.error(JSON.stringify(s),{duration:2e3,position:"bottom-center"});return}else if(J(s)){n.error(s.message,{duration:2e3,position:"bottom-center"});return}p(!1)}finally{p(!1)}else n.error("Mobile number with country code",{duration:2e3,position:"bottom-center"})}async function S(s){try{await y({userId:s.userId,addressId:s.addressId}).unwrap()}catch(a){console.warn(a)}}async function M(s){try{const a=b.filter(B=>B._id!==s.addressId);m(a);const j=await _({userId:s.userId,addressId:s.addressId}).unwrap()}catch(a){console.warn(a)}}return t.useEffect(()=>{},[]),t.useEffect(()=>{(async function(){try{await y({userId:u.userId,addressId:u.id}).unwrap()}catch(s){console.warn(s)}})()},[u.id]),t.useEffect(()=>{o.on("message",s=>{s.status!==200&&typeof s.msg=="string"&&n.error(s.msg,{duration:2e3,position:"bottom-center"}),s.status===200&&typeof s.msg!="string"&&(m(s.msg.reverse()),n.success("added",{duration:2e3,position:"bottom-center"}))})},[o]),e.jsxs("div",{className:"right_side flex-[9] bg-[#bbcade] rounded-md py-3  md:overflow-y-auto",id:"addressScrollbar",children:[d?e.jsx("header",{className:"text-[1.3rem] font-serif pl-8 tracking-wider",children:"Manage Address"}):"",e.jsx("section",{className:"add new address px-3 py-3",children:e.jsx("button",{className:"btn btn-block btn-sm bg-[#025b87]",onClick:()=>{l(!c)},children:"+ add new address"})}),e.jsxs("main",{className:"update px-3 mobile:px-1",children:[e.jsx(D,{children:c&&e.jsxs(v.section,{initial:{scale:0,opacity:0},animate:{scale:1,opacity:1},transition:{duration:.4},exit:{scale:0,opacity:0},className:"new addres box drop-shadow-lg bg-[#a1b5cf] border border-solid border-[#a1b5cf] px-2 mobile:px-0 rounded-md  py-[1rem] gap-y-2 mb-2",children:[e.jsxs("div",{className:"wrapper grid md:grid-cols-2 mobile:grid-cols-1",children:[q.map(s=>e.jsx("div",{className:"name py-2 px-[1.4rem]",children:s.id!==4?s.id===7?e.jsx(e.Fragment,{children:e.jsxs("div",{className:"wrapper_mobile_verify",children:[e.jsx("input",{type:"tel",className:"py-2 font-serif tracking-wider rounded-md indent-3 w-full",placeholder:s.placeHolder,name:"mobile",onChange:f,id:"",minLength:12,maxLength:12,value:s.id===7?r.mobile:""}),e.jsx("p",{className:"pl-4 text-sm py-1 tracking-wider text-[#e40c0c] font-serif",children:"with country code"}),e.jsxs("div",{className:"verify flex items-center",children:[e.jsx("div",{className:"input_otp py-2 pl-3",children:e.jsx("input",{type:"text",name:"",id:"",disabled:!0,className:"py-1 font-serif tracking-wider rounded-md indent-3 w-[5rem]"})}),e.jsx("div",{className:"button pl-4",children:e.jsx("button",{disabled:!0,className:"btn btn-sm",children:"verify"})})]})]})}):e.jsx(e.Fragment,{children:e.jsx("input",{type:"text",className:"py-2 font-serif tracking-wider rounded-md indent-3 w-full",placeholder:s.placeHolder,id:"",value:s.id===1?r.name:s.id===2?r.pincode:s.id===3?r.locality:s.id===5?r.city:s.id===6?r.state:"",maxLength:s.id===2?6:100,onChange:f,name:s.id===1?"name":s.id===2?"pincode":s.id===3?"locality":s.id===5?"city":s.id===6?"state":""})}):e.jsx("textarea",{cols:6,rows:4,className:"w-full  resize-none  py-1 px-2 rounded-md",placeholder:s.placeHolder,onChange:f,name:"address",value:s.id===4?r.address:""})})),e.jsx("div",{className:"get_OTP  w-full py-3 pl-6",children:e.jsx("button",{disabled:!0,className:"btn btn-sm ",children:"OTP"})})]}),c&&e.jsx(v.div,{className:"submit py-3 w-full",children:e.jsx("button",{disabled:!w||x,className:"btn btn-block btn-sm",onClick:()=>{C()},children:x?e.jsx(G,{width:25,height:25}):"Save"})})]})}),e.jsxs("section",{className:"old_addresses",children:[H&&e.jsx("div",{className:"wrapper_error loader_wrapper flex justify-center items-center h-[calc(100vh-10.7rem)]",children:e.jsx("p",{className:"text-lg font-medium tracking-wider ",children:"Opps something went wrong"})}),k?e.jsx("div",{className:"loader_wrapper flex justify-center items-center h-[calc(100vh-10.7rem)]",children:e.jsx(W,{height:50,width:50,color:"#FF0303",wrapperStyle:{},wrapperClass:"",visible:!0,ariaLabel:"oval-loading",secondaryColor:"#4E31AA",strokeWidth:2,strokeWidthSecondary:2})}):b.map(s=>e.jsx(R,{item:s,onActiveAddressHandler:S,deleteAddress:M,setCurrentAddress:N,currentAddress:u},s._id))]})]})]})}export{X as A};
